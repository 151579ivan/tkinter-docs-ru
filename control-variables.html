<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
   <title>Библиотека Tkinter</title>
   <link rel="stylesheet" href="css/xt256.min.css">
   <link rel="stylesheet" href="css/styles.css">
   <script src="css/highlight.min.js"></script>
   <script>hljs.highlightAll();</script>
</head>
<body>

<p><strong><em><a href="index.html">Главная</a></em></strong></p>

<hr />

<h2>52. Управляющие переменные: значения, стоящие за виджетами</h2>

<p><em>Управляющая переменная</em> в Tkinter - это специальный объект, который действует как обычная переменная Python, являясь контейнером для значения, например, числа или строки.</p>

<p>Особенность управляющей переменной заключается в том, что она может быть общей для нескольких различных виджетов, и управляющая переменная может помнить все виджеты, которые в данный момент её используют. Это означает, в частности, что если ваша программа сохранит значение <code>v</code> в управляющей переменной <code>c</code> с помощью метода <code>c.set(v)</code>, то все виджеты, связанные с этой управляющей переменной, автоматически обновятся на экране.</p>

<p>Tkinter использует управляющие переменные для ряда важных функций, например:</p>

<ul>
<li><p>Чекбоксы используют управляющую переменную для хранения текущего состояния кнопки (включена или выключена).</p></li>
<li><p>Одна управляющая переменная используется совместно группой радиобаттонов и может использоваться для определения того, какой из них установлен в данный момент. Когда пользователь нажимает на одну кнопку в группе, совместное использование этой управляющей переменной является механизмом, с помощью которого Tkinter группирует кнопки таким образом, что при установке одной из них все остальные установленные кнопки в группе очищаются.</p></li>
<li><p>Управляющие переменные хранят текстовую строку для нескольких приложений. Обычно текст, отображаемый в виджете <em>Entry</em>, связан с управляющей переменной. В некоторых других элементах управления можно использовать управляющую переменную со строковым значением для хранения текста, например, меток чекбоксов и радиобаттонов, а также содержимого виджетов <em>Label</em>.</p>

<p>Например, можно связать виджет <em>Entry</em> с виджетом <em>Label</em>, чтобы, когда пользователь изменит текст в <em>Entry</em> и нажмет клавишу &lt;Enter>, метка <em>Label</em> автоматически обновилась и отобразила тот же текст.</p></li>
</ul>

<p>Чтобы получить управляющую переменную, используйте один из этих конструкторов класса, в зависимости от того, какой тип значений вам нужно в ней хранить:</p>

<pre><code>v = tk.DoubleVar()  # Хранит float;  значение по умолчанию 0.0
v = tk.IntVar()     # Хранит int;    значение по умолчанию 0
v = tk.StringVar()  # Хранит string; значение по умолчанию ''
</code></pre>

<p><strong>Все управляющие переменные имеют эти два метода:</strong></p>

<p><code>.get()</code></p>

<blockquote>
  <p>Возвращает текущее значение переменной.</p>
</blockquote>

<p><code>.set(value)</code></p>

<blockquote>
  <p>Изменяет текущее значение переменной. Если к этой переменной подчинены какие-либо параметры виджетов, то они будут обновляться при следующем холостом ходе основного цикла; для получения дополнительной информации об управлении этим циклом обновления см. <a href="universal.html#idletasks">.update_idletasks()</a>.</p>
</blockquote>

<hr />

<p>Вот несколько пояснений того, как управляющие переменные используются с конкретными виджетами:</p>

<p><code>Button</code></p>

<blockquote>
  <p>Вы можете установить для ее <code>textvariable</code> значение <code>StringVar</code>. Каждый раз, когда эта переменная изменяется, текст на кнопке будет обновляться, чтобы отобразить новое значение. Это не обязательно, если текст кнопки не будет меняться: используйте атрибут <code>text</code>, если метка кнопки статична.</p>
</blockquote>

<p><code>Checkbutton</code></p>

<blockquote>
  <p>Обычно вы устанавливаете параметр <code>variable</code> виджета в <code>IntVar</code>, и эта переменная будет установлена в 1, когда кнопка включена, и в 0, когда она выключена. Однако вы можете выбрать разные значения для этих двух состояний с помощью опций <code>onvalue</code> и <code>offvalue</code> соответственно.</p>
</blockquote>

<blockquote>
  <p>Вы даже можете использовать <code>StringVar</code> в качестве переменной кнопки и указать строковые значения для <code>offvalue</code> и <code>onvalue</code>. Вот пример:</p>
</blockquote>

<blockquote>
<pre><code>self.spamVar = tk.StringVar()
self.spamCB  = tk.Checkbutton(self, text='Spam?',
    variable=self.spamVar, onvalue='yes', offvalue='no')
</code></pre>
</blockquote>

<blockquote>
  <p>Если эта кнопка включена, <code>self.spamVar.get()</code> вернет строку <code>'yes'</code>; если кнопка выключена, тот же вызов вернет строку <code>'no'</code>. Кроме того, ваша программа может включить <em>checkbutton</em>, вызвав <code>.set('yes')</code>.</p>
</blockquote>

<blockquote>
  <p>Вы также можете передать параметр <code>textvariable</code> <em>checkbutton</em> в <code>StringVar</code>. Затем вы можете изменить текстовую метку на этой кнопке, используя метод <code>.set()</code> для этой переменной.</p>
</blockquote>

<p><code>Entry</code></p>

<blockquote>
  <p>Установите для параметра <code>textvariable</code> значение <code>StringVar</code>. Используйте метод <code>.get()</code> этой переменной, чтобы получить текст, отображаемый в данный момент в виджете. Вы также можете использовать метод переменной <code>.set()</code> для изменения текста, отображаемого в виджете.</p>
</blockquote>

<p><code>Label</code></p>

<blockquote>
  <p>Вы можете установить параметр <code>textvariable</code> в значение <code>StringVar</code>. Тогда любой вызов метода переменной <code>.set()</code> будет изменять текст, отображаемый на метке. Это не нужно, если текст метки статичен; используйте атрибут <code>text</code> для меток, которые не меняются во время работы приложения.</p>
</blockquote>

<p><code>Menubutton</code></p>

<blockquote>
  <p>Если вы хотите иметь возможность изменять текст, отображаемый на кнопке меню, установите параметр <code>textvariable</code> в <code>StringVar</code> и используйте метод <code>.set()</code> этой переменной для изменения отображаемого текста.</p>
</blockquote>

<p><code>Radiobutton</code></p>

<blockquote>
  <p>Опция <code>variable</code> должна быть установлена на управляющую переменную, либо <code>IntVar</code>, либо <code>StringVar</code>. Все радиобаттоны в функциональной группе должны иметь одну и ту же управляющую переменную.</p>
</blockquote>

<blockquote>
  <p>Установите опцию <code>value</code> для каждой радиокнопки в группе в отдельное значение. Всякий раз, когда пользователь устанавливает радиокнопку, переменная будет установлена в значение <code>value</code> этой радиокнопки, а все остальные радиокнопки, входящие в эту группу, будут очищены.</p>
</blockquote>

<blockquote>
  <p>Вы можете задаться вопросом, в каком состоянии находится группа радиобаттонов, если управляющая переменная никогда не была установлена и пользователь никогда не нажимал на них? Каждая управляющая переменная имеет значение по умолчанию: <code>0</code> для <code>IntVar</code>, <code>0.0</code> для <code>DoubleVar</code> и <code>''</code> для <code>StringVar</code>. Если один из радиобаттонов имеет такое значение <code>value</code>, то этот радиобаттон будет установлен в начальное положение. Если ни один из параметров <code>value</code> не совпадает со значением переменной, все радиокнопки будут очищены.</p>
</blockquote>

<blockquote>
  <p>Если вы хотите изменить текстовую метку на радиокнопке во время выполнения вашего приложения, установите для параметра <code>textvariable</code> значение <code>StringVar</code>. Тогда ваша программа сможет изменить текстовую метку, передав новый текст метки в метод переменной <code>.set()</code>.</p>
</blockquote>

<p><code>Scale</code></p>

<blockquote>
  <p>Для виджета шкалы установите опцию <code>variable</code> в управляющую переменную любого класса, а опции <code>from_</code> и <code>to</code> - в предельные значения для противоположных концов шкалы.</p>
</blockquote>

<blockquote>
  <p>Например, вы можете использовать <code>IntVar</code> и установить <code>from_=0</code> и <code>to=100</code> для шкалы. Тогда при каждом изменении виджета пользователем значение переменной будет меняться на некоторое значение между 0 и 100 включительно.</p>
</blockquote>

<blockquote>
  <p>Ваша программа также может перемещать ползунок, используя метод <code>.set()</code> для управляющей переменной. Продолжая пример выше, <code>.set(75)</code> переместит ползунок в положение, занимающее три четверти пути по желобу.</p>
</blockquote>

<blockquote>
  <p>Чтобы настроить виджет шкалы для <code>float</code> значений, используйте <code>DoubleVar</code>.</p>
</blockquote>

<blockquote>
  <p>В качестве управляющей переменной виджета <code>Scale</code> можно использовать <code>StringVar</code>. Вам все равно нужно будет указать числовые значения <code>from_</code> и <code>to</code>, но числовое значение виджета будет преобразовано в строку для хранения в <code>StringVar</code>. Используйте опцию <code>digits</code> шкалы, чтобы контролировать точность преобразования.</p>
</blockquote>

<hr />

<p><strong><em><a href="focus.html">&gt;&gt; Фокус: маршрутизация ввода с клавиатуры</a></em></strong></p>

</body>
</html>
